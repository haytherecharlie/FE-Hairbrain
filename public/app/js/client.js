function cookieCheck(){if(!userid||!jwt)return window.location.href=window.location.origin+"/",!1}var userid=decodeURI($.cookie("userid")),jwt=decodeURI($.cookie("jwt")),name=decodeURI($.cookie("name")),phone=decodeURI($.cookie("phone")),email=decodeURI($.cookie("email")),salon=decodeURI($.cookie("salon")),ClientAdd=function(){function e(){loadingGif.show()}function n(){loadingGif.hide()}function t(){r.each(function(){$(this).val("")}),notes.val(""),$("#photo-front").css("background","none")}function o(){var e=r.length,n=0;r.each(function(){""!==$(this).val()&&n++}),i(n,e)}function i(e,n){e===n?addFormSubmit.prop("disabled",!1):addFormSubmit.prop("disabled",!0)}function a(){var e=new FormData;e.append("firstname",firstname.val()),e.append("lastname",lastname.val()),e.append("phone",phone.val()),e.append("notes",notes.val()),e.append("photofront",photofront[0].files[0],"photofront.jpg"),e.append("name",name);var o={async:!0,crossDomain:!0,url:apiurl+"client/add/"+userid,method:"POST",headers:{"cache-control":"no-cache",Authorization:"Bearer "+jwt},processData:!1,contentType:!1,mimeType:"multipart/form-data",data:e};$.ajax(o).done(function(e,o){"success"===o&&(ClientList.clientListAJAX(),t(),addClientModal.modal("hide"),n())})}var c=$(".clientaddform"),r=$(".clientaddform input");addFormSubmit=$(".clientaddsubmit"),clientAddBtn=$(".clientadd"),closeModal=$(".closemodal"),addClientModal=$(".addmodal"),firstname=$('.clientaddform input[name="firstname"]'),lastname=$('.clientaddform input[name="lastname"]'),phone=$('.clientaddform input[name="phone"]'),notes=$('.clientaddform textarea[name="notes"]'),photofront=$('.clientaddform input[name="photofront"]'),thumbFront=$("#photo-front"),loadingGif=$(".savingclient"),c.submit(function(n){n.preventDefault(),e(),a(),t()}),clientAddBtn.click(function(){o(),addClientModal.modal("show")}),closeModal.click(function(){t()}),$(document).keypress(":input:not(textarea)",function(e){return 13!=e.keyCode}),r.not('input[type="button"]').change(function(){o()})}(),Menu=function(){function e(){a.show(),i.animate({top:50},300),o.animate({opacity:1},300),i.addClass("open")}function n(){i.animate({top:50-i.height()},300,function(){a.hide()}),o.animate({opacity:0},300),i.removeClass("open")}function t(){i.hasClass("open")?i.css("top",50):i.css("top",50-i.height())}var o=$(".menuoverlay"),i=$(".menuitems"),a=$("menu"),c=$(".report"),r=$(".logout");return o.click(function(){n()}),r.click(function(){$.removeCookie("jwt",{path:"/"}),$.removeCookie("userid",{path:"/"}),window.location.href=window.location.origin+"/"}),c.click(function(){$(".issueModal").modal("show"),n()}),$(window).on("resize",function(){t()}),{openMenu:e,closeMenu:n}}(),Nav=function(){function e(){g.animate({left:"100vw"},500,function(){g.scrollTop(0)}),i(),t()}function n(){m.fadeOut(),w.hide()}function t(){m.fadeIn(),w.show()}function o(){v.fadeIn()}function i(){v.fadeOut()}function a(){var e=$(window).width()-40;p.fadeOut(300),k.fadeOut(300),C.fadeIn(300),u(),w.addClass("open"),m.animate({right:"+="+(e-10)+"px"},300,function(){w.show(),w.focus()})}function c(){w.blur();$(window).width();p.fadeIn(300),k.fadeIn(300),C.fadeOut(300),w.removeClass("open"),m.animate({right:"10px"},300,function(){d(),w.val(""),w.trigger("keyup")})}function r(){k.fadeIn(),p.fadeIn(),m.hide(),C.hide(),m.css("right","10px"),w.removeClass("open"),w.removeClass("open")}function s(){setTimeout(function(){w.val(""),w.trigger("keyup"),d()},300)}function l(){var e=$(window).width()-30;m.css("right",e-10)}function d(){$(".letter").each(function(){$(this).fadeIn(300)})}function u(){$(".letter").each(function(){$(this).fadeOut(300)})}function f(e,n){return-1!=e.toLowerCase().indexOf(n.toLowerCase())}var p=$(".hamburger"),h=$(".menuitems"),m=$(".navsearch"),v=$(".exitprofile"),g=$(".clientprofile"),w=$(".searchfield"),k=$(".navlogo"),C=$(".cancelsearch");return p.click(function(){h.hasClass("open")?Menu.closeMenu():Menu.openMenu()}),v.click(function(){e(),h.hasClass("open")&&Menu.closeMenu()}),w.click(function(){w.hasClass("open")?c():a(),h.hasClass("open")&&Menu.closeMenu()}),$(window).on("resize",function(){w.hasClass("open")&&l()}),w.keyup(function(){var e=$(this).val();$(".clientcard").each(function(){$(this).toggle(f($(this).data("name"),e))})}),C.click(function(){c()}),{showSearch:t,hideSearch:n,showBackBtn:o,hideBackBtn:i,slideSearchClosed:c,quickClearSearch:r,restoreList:s,slideClientProfile:e}}(),ClientProfile=function(){function e(e){o.attr("id",e._id),i.attr("src",apiurl+"photo/"+e.userid+"/"+e._id+"/avatar.jpg"),a.text(e.firstname),c.text(e.lastname),r.html('<a href="tel:'+e.phone+'">'+e.phone+"</a>"),s.attr("src",apiurl+"photo/"+e.userid+"/"+e._id+"/photofront.jpg"),l.attr("src",apiurl+"photo/"+e.userid+"/"+e._id+"/photoleft.jpg"),d.attr("src",apiurl+"photo/"+e.userid+"/"+e._id+"/photoback.jpg"),u.attr("src",apiurl+"photo/"+e.userid+"/"+e._id+"/photoright.jpg"),f.val(e.notes)}function n(){deleteModal.modal("show")}function t(){var e=o.attr("id"),n={async:!0,crossDomain:!0,url:apiurl+"client/delete/"+userid+"/"+e,method:"DELETE",headers:{"cache-control":"no-cache",Authorization:"Bearer "+jwt},processData:!1,contentType:!1};$.ajax(n).done(function(e,n){"success"===n&&(ClientList.clientListAJAX(),Nav.slideClientProfile())})}var o=$(".clientprofile"),i=$(".avatar"),a=$(".clientprofile .firstname"),c=$(".clientprofile .lastname"),r=$(".clientprofile .phone"),s=$(".clientprofile .photofront"),l=$(".clientprofile .photoleft"),d=$(".clientprofile .photoback"),u=$(".clientprofile .photoright"),f=$(".clientprofile .notes");return deleteModal=$(".deleteModal"),$(".deleteclient").click(function(){n()}),$(".confirmDelete").click(function(){t()}),{populateProfile:e}}(),ClientList=function(){function e(){$(".clientcard").each(function(){$(this).click(function(){ClientProfile.populateProfile(clientlist[$(this).attr("id")]),Nav.quickClearSearch(),a.animate({left:"0"},500,function(){Nav.restoreList(),i.scrollTop(0)}),Nav.hideSearch(),Nav.showBackBtn()})})}function n(n){for(var o in n)t(n,o),i.append('<div class="clientcard" id="'+o+'" data-name="'+n[o].firstname+n[o].lastname+'"><div class="avatar"><img src="'+apiurl+"photo/"+userid+"/"+n[o]._id+'/avatar.jpg"></div><span class="firstname">'+n[o].firstname+'</span><span class="lastname"> '+n[o].lastname+"</span></div>");e()}function t(e,n){"0"===n&&i.append('<div class="letter">'+e[n].firstname.charAt(0)+"</div>"),n>0&&n<e.length&&e[n].firstname.charAt(0)!==e[n-1].firstname.charAt(0)&&i.append('<div class="letter">'+e[n].firstname.charAt(0).toUpperCase()+"</div>")}function o(){cookieCheck();var e={async:!0,crossDomain:!0,url:apiurl+"client/all/"+userid,method:"GET",headers:{"cache-control":"no-cache",Authorization:"Bearer "+jwt},processData:!1,contentType:!1};$.ajax(e).done(function(e,t){"success"===t&&(clientlist=e,i.empty(),0===clientlist.length?i.append("<div class=\"empty\">You don't have any clients, <br> Click the '+' below to get started!</div>"):n(e))})}var i=$(".clientlist"),a=$(".clientprofile");return o(),{clientListAJAX:o}}();!function(){var e={$src:"",$dest:"",photoListeners:function(){$(".thumbnail").each(function(){$(this).click(function(){var n=$(this).attr("id");e.$src=$("#"+n),e.$dest=$("#select-"+n),e.$dest.click(),e.photoUploaded()})})},photoUploaded:function(){e.$dest.change(function(n){e.resizeImage(this.files[0])})},resizeImage:function(n){ImageTools.resize(n,{width:320,height:440},function(n,t){e.getPhotoDimensions(n)})},getPhotoDimensions:function(n){var t=new FileReader;t.onload=function(){var o=new Image;o.onload=function(){e.rotatePhoto(o,n)},o.src=t.result},t.readAsDataURL(n)},rotatePhoto:function(n,t){n.height<n.width?(e.$src.removeClass("default"),e.$src.addClass("rotate")):(e.$src.removeClass("rotate"),e.$src.addClass("default")),e.$src.css("background","url("+n.src+") no-repeat center"),e.$src.css("background-size","cover"),console.log(n.src)}};e.photoListeners()}();var PhotoWidget=function(){function e(e){o.removeClass("focus"),e.addClass("focus"),o=e}var n=$(".thumbfront"),t=[n],o=n;for(var i in t)t[i].click(function(){e($(this))})}(),ReportIssue=function(){function e(){var e=new FormData;e.append("name",name),e.append("phone",phone),e.append("email",email),e.append("salon",salon),e.append("issue",$(".issueform").val());var n={async:!0,crossDomain:!0,url:"https://script.google.com/macros/s/AKfycbxwK0uSZtglD0qBQKwqNOzfM-1JDMjIusr4FL3i6bkpAkL-QCOH/exec",method:"POST",processData:!1,contentType:!1,data:e};$.ajax(n).done(function(e,n){})}$(".confirmReport").click(function(){e()})}(),ProfileModal=function(){function e(){a.attr("src","")}function n(){c.text(name)}function t(){r.text(phone)}function o(){s.text(email)}function i(){l.text(salon)}var a=($(".profilemodal"),$(".profilemodal #profilephoto")),c=$(".profilemodal #name"),r=$(".profilemodal #phone"),s=$(".profilemodal #phone"),l=$(".profilemodal #salon");!function(){e(),n(),t(),o(),i()}()}();